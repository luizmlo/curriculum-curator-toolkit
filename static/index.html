<!DOCTYPE html>
<!--
================================================================================
KIT DO PROFESSOR CURADOR - Interface HTML Principal
================================================================================

ESTRUTURA:
- SeÃ§Ã£o de ConfiguraÃ§Ã£o: Input de tÃ³pico e seleÃ§Ã£o de workflow
- SeÃ§Ã£o de Fontes: Lista de fontes de pesquisa encontradas
- SeÃ§Ã£o de CurrÃ­culo: Editor interativo com dois blocos de habilidades
- Modais: EdiÃ§Ã£o de cards, histÃ³rico de sessÃµes, method cards, chatbot

FLUXO DE USUÃRIO:
1. UsuÃ¡rio digita tÃ³pico â†’ Escolhe workflow (manual/pesquisar/gerar)
2. Se pesquisar â†’ VÃª fontes â†’ Seleciona â†’ Gera currÃ­culo
3. Se gerar direto â†’ CurrÃ­culo gerado com IA
4. Se manual â†’ Adiciona cards manualmente
5. Edita/reordena cards â†’ Gera prompts para ferramentas
6. Salva/carrega sessÃµes â†’ PersistÃªncia no LocalStorage

DEPENDÃŠNCIAS:
- styles.css: Estilos visuais
- script.js: Toda a lÃ³gica JavaScript
- Backend FastAPI: API REST para processamento com IA
================================================================================
-->
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kit do Professor Curador</title>
    <link rel="stylesheet" href="/static/styles.css?v=3.0">
</head>
<body>
    <div class="container">
        <header>
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <div>
                    <h1>ğŸ“ ToolKit do Professor Curador</h1>
                    <p class="subtitle">Assistente de Planejamento Curricular com IA</p>
                </div>
                <div>
                    <button id="save-session-btn" class="btn btn-secondary" onclick="saveCurrentSession()" style="display: none;">ğŸ’¾ Salvar SessÃ£o</button>
                    <button id="sessions-history-btn" class="btn btn-secondary" onclick="openSessionsModal()">ğŸ“š HistÃ³rico</button>
                </div>
            </div>
        </header>

        <!-- SeÃ§Ã£o de Entrada do TÃ³pico -->
        <section class="section" id="topic-section">
            <h2>1. Configurar CurrÃ­culo</h2>
            <div class="form-group" style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 10px; font-weight: 600; color: #333;">TÃ³pico do CurrÃ­culo:</label>
                <input type="text" id="topic-input" placeholder="ex.: MecÃ¢nica dos Fluidos, IntroduÃ§Ã£o a CiberseguranÃ§a, Quimica Organica..." class="topic-input" style="width: 100%;">
            </div>
            
            <div class="form-group" style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 10px; font-weight: 600; color: #333;">Como deseja proceder?</label>
                <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                    <label class="workflow-option">
                        <input type="radio" name="workflow-mode" value="manual" checked onchange="updateWorkflowMode()">
                        <span class="workflow-option-text"><strong>Criar Manualmente</strong><br><small>Adicionar habilidades manualmente</small></span>
                    </label>
                    <label class="workflow-option">
                        <input type="radio" name="workflow-mode" value="direct" onchange="updateWorkflowMode()">
                        <span class="workflow-option-text"><strong>Gerar CurrÃ­culo Diretamente</strong><br><small>Sem pesquisar fontes primeiro</small></span>
                    </label>
                    <label class="workflow-option">
                        <input type="radio" name="workflow-mode" value="research" onchange="updateWorkflowMode()">
                        <span class="workflow-option-text"><strong>Pesquisar Fontes Primeiro</strong><br><small>Encontrar fontes antes de gerar</small></span>
                    </label>
                </div>
            </div>
            
            <div id="workflow-actions">
                <button id="manual-create-btn" class="btn btn-primary">Criar CurrÃ­culo Manualmente</button>
                <button id="direct-generate-btn" class="btn btn-primary" style="display: none;">Gerar CurrÃ­culo</button>
                <button id="research-btn" class="btn btn-primary" style="display: none;">Pesquisar Fontes</button>
            </div>
            
            <div id="loading-indicator" class="loading" style="display: none;">
                <div class="spinner"></div>
                <span id="loading-text">Processando...</span>
            </div>
        </section>

        <!-- SeÃ§Ã£o de Fontes de Pesquisa -->
        <section class="section" id="sources-section" style="display: none;">
            <h2>2. Fontes de Pesquisa</h2>
            <div class="sources-actions" style="margin-bottom: 20px;">
                <button id="skip-sources-btn" class="btn btn-secondary">Pular e Gerar CurrÃ­culo Diretamente</button>
                <button id="delete-selected-btn" class="btn btn-danger" style="display: none;" onclick="deleteSelectedSources()">Remover Selecionadas</button>
            </div>
            <p class="instruction" style="margin-bottom: 15px;">Clique nas fontes para selecionÃ¡-las. As fontes selecionadas serÃ£o usadas na geraÃ§Ã£o do currÃ­culo.</p>
            <div id="sources-list" class="sources-grid"></div>
            <button id="generate-curriculum-btn" class="btn btn-primary" style="margin-top: 20px;">Gerar CurrÃ­culo com Fontes Selecionadas</button>
        </section>

        <!-- SeÃ§Ã£o de Editor de CurrÃ­culo -->
        <section class="section" id="curriculum-section" style="display: none;">
            <h2>CurrÃ­culo de Habilidades</h2>
            <p class="instruction">Arraste os cartÃµes para reordenar, clique para editar ou use os botÃµes para adicionar/remover habilidades. Cada item representa uma habilidade progressiva que se constrÃ³i sobre as anteriores. VocÃª pode adicionar habilidades manualmente ou gerar com IA depois.</p>
            
            <div class="blocks-container">
                <!-- Bloco 1 -->
                <div class="block-wrapper">
                    <div class="block-header">
                        <h3>Bloco 1: Fundamentos</h3>
                        <button class="btn btn-small btn-add" onclick="addCard('block1')">+ Adicionar Habilidade</button>
                    </div>
                    <div id="block1" class="card-container" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                </div>

                <!-- Bloco 2 -->
                <div class="block-wrapper">
                    <div class="block-header">
                        <h3>Bloco 2: AplicaÃ§Ãµes PrÃ¡ticas</h3>
                        <button class="btn btn-small btn-add" onclick="addCard('block2')">+ Adicionar Habilidade</button>
                    </div>
                    <div id="block2" class="card-container" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                </div>
            </div>

            <div style="display: flex; gap: 15px; margin-top: 30px; flex-wrap: wrap;">
                <p class="instruction" style="flex: 1; min-width: 100%; margin-bottom: 10px; padding: 15px; background: #f0f4ff; border-radius: 8px; border-left: 4px solid #667eea;">
                    ğŸ’¡ <strong>Como usar:</strong> Clique no botÃ£o <strong>"ğŸ“‹ Prompts"</strong> em cada habilidade do currÃ­culo para criar prompts personalizados para diferentes ferramentas de ensino (vÃ­deo, guia teÃ³rico, podcast, visualizaÃ§Ã£o interativa e quiz).
                </p>
                <button id="save-session-curriculum-btn" class="btn btn-secondary" onclick="saveCurrentSession()">ğŸ’¾ Salvar SessÃ£o</button>
            </div>
        </section>

    </div>

    <!-- Modal de EdiÃ§Ã£o de CartÃ£o -->
    <div id="edit-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeEditModal()">&times;</span>
            <div class="edit-modal-header">
                <h3>Editar Habilidade</h3>
            </div>
            <div class="edit-modal-body">
                <div class="form-group">
                    <label>TÃ­tulo da Habilidade:</label>
                    <input type="text" id="edit-title" class="form-input">
                </div>
                <div class="form-group">
                    <label>DescriÃ§Ã£o:</label>
                    <textarea id="edit-description" class="form-textarea"></textarea>
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeEditModal()">Cancelar</button>
                <button class="btn btn-primary" onclick="saveCardEdit()">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Modal de HistÃ³rico de SessÃµes -->
    <div id="sessions-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeSessionsModal()">&times;</span>
            <div class="edit-modal-header">
                <h3>ğŸ“š HistÃ³rico de SessÃµes</h3>
            </div>
            <div class="edit-modal-body">
                <div id="sessions-list">
                    <!-- SessÃµes serÃ£o listadas aqui -->
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeSessionsModal()">Fechar</button>
            </div>
        </div>
    </div>

    <!-- Modal de Salvar SessÃ£o -->
    <div id="save-session-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeSaveSessionModal()">&times;</span>
            <div class="edit-modal-header">
                <h3>ğŸ’¾ Salvar SessÃ£o</h3>
            </div>
            <div class="edit-modal-body">
                <div class="form-group">
                    <label>Nome da SessÃ£o:</label>
                    <input type="text" id="session-name-input" class="form-input" placeholder="ex.: MecÃ¢nica dos Fluidos - 2024">
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeSaveSessionModal()">Cancelar</button>
                <button class="btn btn-primary" onclick="confirmSaveSession()">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Modal de Method Cards -->
    <div id="method-cards-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeMethodCardsModal()">&times;</span>
            <div class="modal-header-section">
                <h3 id="method-cards-modal-title">ğŸ“‹ Gerar Prompts Personalizados</h3>
                <p class="instruction" id="method-cards-modal-description"></p>
                <p class="instruction modal-tip">
                    ğŸ’¡ <strong>ExperiÃªncia Curated:</strong> Gere prompts individualmente para cada ferramenta conforme sua necessidade. Cada prompt Ã© personalizado para esta habilidade especÃ­fica, usando o contexto do curso e habilidades prÃ©-requisitas.
                </p>
            </div>
            
            <div class="modal-scrollable-content">
                <div class="method-cards-container">
                    <!-- Method Card 1: Video -->
                    <div class="method-card" data-type="video">
                        <div class="method-card-header">
                            <h4>ğŸ¥ VÃ­deo Educativo</h4>
                            <a href="https://invideo.io/" target="_blank" rel="noopener noreferrer" class="method-card-tool">inVideo AI</a>
                        </div>
                        <p class="method-card-description">Gera prompt para criar vÃ­deo educativo de 60-90 segundos</p>
                        <div class="method-card-actions">
                            <button class="btn btn-small btn-primary" onclick="generateMethodCardPrompt('video')">Gerar</button>
                            <button class="btn btn-small btn-secondary" onclick="editMethodCardPrompt('video')" style="display: none;" id="edit-video-btn">Editar</button>
                        </div>
                        <div class="method-card-result" id="result-video" style="display: none;">
                            <textarea class="method-card-prompt-textarea" id="prompt-video" readonly></textarea>
                            <button class="btn btn-small" onclick="copyMethodCardPrompt('video')">Copiar</button>
                        </div>
                    </div>

                    <!-- Method Card 2: Theory -->
                    <div class="method-card" data-type="theory">
                        <div class="method-card-header">
                            <h4>ğŸ“š Guia TeÃ³rico</h4>
                            <a href="https://notebooklm.google.com/" target="_blank" rel="noopener noreferrer" class="method-card-tool">NotebookLM</a>
                        </div>
                        <p class="method-card-description">Gera prompt para criar guia de estudo analÃ­tico</p>
                        <div class="method-card-actions">
                            <button class="btn btn-small btn-primary" onclick="generateMethodCardPrompt('theory')">Gerar</button>
                            <button class="btn btn-small btn-secondary" onclick="editMethodCardPrompt('theory')" style="display: none;" id="edit-theory-btn">Editar</button>
                        </div>
                        <div class="method-card-result" id="result-theory" style="display: none;">
                            <textarea class="method-card-prompt-textarea" id="prompt-theory" readonly></textarea>
                            <button class="btn btn-small" onclick="copyMethodCardPrompt('theory')">Copiar</button>
                        </div>
                    </div>

                    <!-- Method Card 3: Case Study -->
                    <div class="method-card" data-type="case_study">
                        <div class="method-card-header">
                            <h4>ğŸ™ï¸ Estudo de Caso (Podcast)</h4>
                            <a href="https://elevenlabs.io/" target="_blank" rel="noopener noreferrer" class="method-card-tool">ElevenLabs</a>
                        </div>
                        <p class="method-card-description">Gera roteiro de podcast estilo true crime educativo</p>
                        <div class="method-card-actions">
                            <button class="btn btn-small btn-primary" onclick="generateMethodCardPrompt('case_study')">Gerar</button>
                            <button class="btn btn-small btn-secondary" onclick="editMethodCardPrompt('case_study')" style="display: none;" id="edit-case_study-btn">Editar</button>
                        </div>
                        <div class="method-card-result" id="result-case_study" style="display: none;">
                            <textarea class="method-card-prompt-textarea" id="prompt-case_study" readonly></textarea>
                            <button class="btn btn-small" onclick="copyMethodCardPrompt('case_study')">Copiar</button>
                        </div>
                    </div>

                    <!-- Method Card 4: Practice -->
                    <div class="method-card" data-type="practice">
                        <div class="method-card-header">
                            <h4>ğŸ”¬ VisualizaÃ§Ã£o Interativa</h4>
                            <a href="https://colab.research.google.com/" target="_blank" rel="noopener noreferrer" class="method-card-tool">Google Colab</a>
                        </div>
                        <p class="method-card-description">Gera cÃ³digo Python para laboratÃ³rio virtual interativo</p>
                        <div class="method-card-actions">
                            <button class="btn btn-small btn-primary" onclick="generateMethodCardPrompt('practice')">Gerar</button>
                            <button class="btn btn-small btn-secondary" onclick="editMethodCardPrompt('practice')" style="display: none;" id="edit-practice-btn">Editar</button>
                        </div>
                        <div class="method-card-result" id="result-practice" style="display: none;">
                            <textarea class="method-card-prompt-textarea" id="prompt-practice" readonly></textarea>
                            <button class="btn btn-small" onclick="copyMethodCardPrompt('practice')">Copiar</button>
                        </div>
                    </div>

                    <!-- Method Card 5: Quiz -->
                    <div class="method-card" data-type="quiz">
                        <div class="method-card-header">
                            <h4>ğŸ“ Quiz de DiagnÃ³stico</h4>
                            <a href="https://forms.google.com/" target="_blank" rel="noopener noreferrer" class="method-card-tool">Google Forms</a>
                        </div>
                        <p class="method-card-description">Gera questÃµes de mÃºltipla escolha, com gabarito e explicaÃ§Ãµes</p>
                        <div class="method-card-actions">
                            <button class="btn btn-small btn-primary" onclick="generateMethodCardPrompt('quiz')">Gerar</button>
                            <button class="btn btn-small btn-secondary" onclick="editMethodCardPrompt('quiz')" style="display: none;" id="edit-quiz-btn">Editar</button>
                        </div>
                        <div class="method-card-result" id="result-quiz" style="display: none;">
                            <textarea class="method-card-prompt-textarea" id="prompt-quiz" readonly></textarea>
                            <button class="btn btn-small" onclick="copyMethodCardPrompt('quiz')">Copiar</button>
                        </div>
                    </div>
                </div>

                <div class="modal-actions">
                    <button class="btn btn-secondary" onclick="closeMethodCardsModal()">Fechar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Chatbot Button -->
    <button id="chatbot-floating-btn" class="chatbot-floating-btn" onclick="toggleChatbot()" title="Assistente de CurrÃ­culo">
        ğŸ’¬
    </button>

    <!-- Chatbot Modal -->
    <div id="chatbot-modal" class="modal">
        <div class="modal-content chatbot-modal-content">
            <span class="close" onclick="toggleChatbot()">&times;</span>
            <div class="modal-header-section">
                <h3>ğŸ’¬ Assistente de CurrÃ­culo</h3>
                <p class="instruction">PeÃ§a para adicionar, editar, remover ou reordenar habilidades do currÃ­culo usando linguagem natural.</p>
            </div>
            <div class="modal-scrollable-content chatbot-messages-container">
                <div id="chatbot-messages" class="chatbot-messages"></div>
            </div>
            <div class="chatbot-input-container">
                <input type="text" id="chatbot-input" class="chatbot-input" placeholder="Digite seu comando... (ex: Adicione um card sobre Python no bloco 1)" onkeypress="handleChatbotKeyPress(event)">
                <button id="chatbot-send-btn" class="btn btn-primary btn-small" onclick="sendChatbotMessage()">Enviar</button>
            </div>
        </div>
    </div>

    <script src="/static/script.js?v=2.0"></script>
</body>
</html>
